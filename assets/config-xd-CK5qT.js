import{_ as ne,v as se,n as ie,b as r,r as re,y as de,c as w,e as i,$ as ce,o as b,f as ue,q as H,l as t,k as a,u as o,z as me,j as V,L as $,d as pe,a0 as z,G as q,E as u,K as N,x as B}from"./element-Di_zbn_f.js";import{g as fe,r as R,a as _e}from"./config-D2WKA8SM.js";import{e as ge}from"./element-resize-detector-BdDcWLZ0.js";import ve from"./detail-DlGvF4O8.js";import he from"./config-Cf-2ebxA.js";import{a as we}from"./main-CUtMfDLK.js";import"./methods-B1mA7CrZ.js";import"./taskNode-Dz4-JsLt.js";import"./addTask-D6xlTveK.js";import"./task-cmnfkzQF.js";const be={class:"content-div"},ye={class:"search-div"},Ce={class:"button-div"},De=pe({name:"config"}),ke=Object.assign(De,{setup(xe){se(()=>{ge().listenTo(document.getElementsByClassName("search-div"),()=>{ie(()=>{let e=document.getElementsByClassName("el-container")[0].clientHeight;document.getElementsByClassName("search-div")[0].clientHeight<100?C.value=e-250+"px":C.value=e-290+"px"})})}),we();const g=r(1),y=r(20),j=r(0),C=r(500);r(""),r(!1);const d=r(!1);r("新增");const m=r(!1),v=r(!1),h=r(!1);r([]);const s=re({selectionList:[],query:{jobDesc:"",author:""},tableData:[],rowData:{}}),{selectionList:Ve,query:p,tableData:S,nextTimeList:ze,rowData:L}=de(s);w(()=>B().curNav||[]),w(()=>B().menuList||[]);const U=w(()=>B().executorHandlerList||[]),M=w(()=>{let l=[];return s.selection.forEach(e=>{l.push(e.id)}),l.join(",")}),c=()=>{v.value=!0;let l={};Object.keys(s.query).forEach(e=>{s.query[e]&&(l[e]=s.query[e])}),fe(g.value,y.value,l).then(e=>{s.tableData=e.data.data.records||[],j.value=e.data.data.total,v.value=!1}).catch(()=>v.value=!1)},O=()=>{g.value=1,c()},P=()=>{s.query.jobDesc="",s.query.author="",c()},A=l=>{y.value=l,c()},G=l=>{g.value=l,c()},I=l=>{s.selectionList=l},K=()=>{s.rowData={},h.value=!0,d.value=!0},F=l=>{s.rowData=l,h.value=!1,d.value=!0},J=l=>{_e(l.id).then(e=>{s.rowData=e.data.data,m.value=!0})},Q=()=>{if(s.selectionList.length===0){z.warning("请选择至少一条数据");return}q.confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>R(M.value)).then(()=>{c(),z({type:"success",message:"操作成功!"})})},W=l=>{q.confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>R(l.id)).then(()=>{c(),z({type:"success",message:"操作成功!"})})};return c(),(l,e)=>{const D=i("el-input"),k=i("el-form-item"),f=i("el-button"),X=i("el-form"),_=i("el-table-column"),Y=i("arrow-down"),Z=i("el-icon"),x=i("el-dropdown-item"),ee=i("el-dropdown-menu"),te=i("el-dropdown"),oe=i("el-table"),ae=i("el-pagination"),T=i("el-dialog"),le=ce("loading");return b(),ue("div",be,[H("div",ye,[t(X,{inline:!0,model:o(p),class:"demo-form-inline"},{default:a(()=>[t(k,{label:"任务组描述:"},{default:a(()=>[t(D,{modelValue:o(p).jobDesc,"onUpdate:modelValue":e[0]||(e[0]=n=>o(p).jobDesc=n),placeholder:"任务组描述",size:"small",clearable:""},null,8,["modelValue"])]),_:1}),t(k,{label:"负责人:"},{default:a(()=>[t(D,{modelValue:o(p).author,"onUpdate:modelValue":e[1]||(e[1]=n=>o(p).author=n),placeholder:"负责人",size:"small",clearable:""},null,8,["modelValue"])]),_:1}),t(k,null,{default:a(()=>[t(f,{type:"primary",onClick:O,size:"small",icon:"Search"},{default:a(()=>[u("查询")]),_:1}),t(f,{onClick:P,size:"small",icon:"Refresh"},{default:a(()=>[u("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),H("div",Ce,[t(f,{type:"primary",onClick:K,size:"small",icon:"Plus"},{default:a(()=>[u("新增")]),_:1}),t(f,{type:"danger",onClick:Q,size:"small",icon:"Minus"},{default:a(()=>[u("批量删除")]),_:1})]),me((b(),V(oe,{data:o(S),ref:"tableDataRef",height:o(C),border:"",style:{width:"100%"},"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading",onSelectionChange:I},{default:a(()=>[t(_,{type:"selection",width:"55"}),t(_,{prop:"id",label:"任务组编号","show-overflow-tooltip":""}),t(_,{prop:"jobDesc",label:"任务组描述","show-overflow-tooltip":""}),t(_,{prop:"author",label:"负责人","show-overflow-tooltip":""}),t(_,{fixed:"right",label:"操作",width:"220"},{default:a(n=>[t(te,null,{dropdown:a(()=>[t(ee,{slot:"dropdown"},{default:a(()=>[t(x,{onClick:E=>F(n.row)},{default:a(()=>[u("编辑")]),_:2},1032,["onClick"]),t(x,{onClick:E=>J(n.row)},{default:a(()=>[u("配置")]),_:2},1032,["onClick"]),t(x,{onClick:E=>W(n.row)},{default:a(()=>[u("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),default:a(()=>[t(f,{type:"primary",size:"small",class:"operating-button"},{default:a(()=>[u(" 操 作 "),t(Z,{class:"el-icon--right"},{default:a(()=>[t(Y)]),_:1})]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data","height"])),[[le,o(v)]]),t(ae,{onSizeChange:A,onCurrentChange:G,"current-page":o(g),"page-sizes":[10,20,50,100],"page-size":o(y),layout:"->, total, sizes, prev, pager, next",total:o(j)},null,8,["current-page","page-size","total"]),t(T,{title:o(h)?"新增":"编辑","close-on-click-modal":!1,"close-on-press-escape":!1,modelValue:o(d),"onUpdate:modelValue":e[4]||(e[4]=n=>$(d)?d.value=n:null),width:"30%",top:"8vh"},{default:a(()=>[o(d)?(b(),V(o(ve),{key:0,ref:"taskDetail","row-data":o(L),"is-add":o(h),onRefreshData:e[2]||(e[2]=n=>{d.value=!1,c()}),onHandleClose:e[3]||(e[3]=n=>d.value=!1)},null,8,["row-data","is-add"])):N("",!0)]),_:1},8,["title","modelValue"]),t(T,{title:"配置",modelValue:o(m),"onUpdate:modelValue":e[7]||(e[7]=n=>$(m)?m.value=n:null),"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:""},{default:a(()=>[o(m)?(b(),V(o(he),{key:0,"row-data":o(L),"job-type-list":o(U),onRefreshList:e[5]||(e[5]=n=>{d.value=!1,c()}),onHandleClose:e[6]||(e[6]=n=>m.value=!1),ref:"workflowConfig"},null,8,["row-data","job-type-list"])):N("",!0)]),_:1},8,["modelValue"])])}}}),Se=ne(ke,[["__scopeId","data-v-e647ead7"]]);export{Se as default};
