import{_ as Y,v as Z,b as g,r as ee,y as ae,w as te,e as f,$ as le,o as h,f as S,q as i,l,u as a,L as oe,k as n,z as B,B as ne,j as N,K as E,d as se,a3 as re,n as de,a1 as ie,a0 as u,G as ue,E as m,m as me,t as U,A as ce,H as pe,I as fe,M as ge}from"./element-Di_zbn_f.js";import{g as ve,u as _e,a as ye,r as xe}from"./menu-AIPFbCUU.js";const A=b=>(pe("data-v-a950e382"),b=b(),fe(),b),he={class:"content-div"},be={class:"left-div"},Ve={class:"main-search"},Fe={class:"search-box"},De={class:"button-div"},we={style:{"padding-left":"4px","font-size":"12px"}},Ce={class:"right-div"},ke=A(()=>i("div",{class:"title"},[i("p",null,[i("span"),m("详细信息")])],-1)),ze=A(()=>i("div",{class:"custom-content"},[m(" 如果类型为iframe,请在此填完整的地址,例如:"),i("br"),m(" http://xxxxx:xxxx/xxxxx/xxxxx.html"),i("br")],-1)),Ne={class:"operation-btn"},Ie=se({name:"menu"}),Te=Object.assign(Ie,{setup(b){Z(()=>{I.value=document.getElementsByClassName("el-container")[0].clientHeight-260});const{proxy:y}=ge(),V=g(!1),F=g(""),c=g(!1),x=g(""),k=g(1),D=g(!1),I=g(0),v=g("新增"),o=ee({defaultExpandedArr:[],treeData:[],defaultProps:{children:"children",label:"name"},rules:{name:[{required:!0,message:"请填写名称",trigger:"blur"}],code:[{required:!0,message:"请填写编号",trigger:"blur"}],category:[{required:!0,message:"请选择类型",trigger:"change"}],path:[{required:!0,message:"请填写路由地址",trigger:"blur"}]},menuForm:{id:"",code:"",name:"",parentId:"",parentName:"",path:"",sort:"",category:"1",icon:"Coin"},nodeData:{}}),{defaultExpandedArr:$,treeData:q,defaultProps:M,rules:R,menuForm:t,nodeData:Se}=ae(o);te(()=>F.value,r=>{y.$refs.menuTree.filter(r)});const w=()=>{V.value=!0,ve().then(r=>{o.treeData=r.data.data||[],V.value=!1,!re(o.menuForm)&&x.value&&de(()=>{o.defaultExpandedArr=[o.menuForm.parentId],y.$refs.menuTree.setCurrentKey(x.value)})}).catch(()=>{V.value=!1})},L=(r,e)=>r?e.name.indexOf(r)!==-1:!0,O=(r,e)=>{o.menuForm=ie(r),o.nodeData=e,k.value=e.level,v.value="修改",D.value=!1,y.$refs.menuFormRef.resetFields()},P=(r,e)=>e.category&&e.category==="2"?"StarFilled":e.icon&&e.category&&(e.category==="1"||e.category==="3")?e.icon:r.expanded?"FolderOpened":"Folder",j=()=>{if(!o.nodeData.data){u.warning("请先选择节点");return}o.menuForm={id:"",code:"",name:"",path:"",sort:"",category:"1",icon:"Coin",parentId:o.nodeData.data.id,parentName:o.nodeData.data.name},D.value=!0,v.value="保存"},H=()=>{if(!o.nodeData.id){u.warning("请先选择节点");return}if(k.value===1&&!D.value){u.warning("系统节点不能修改");return}let r=0,e=[];o.menuForm.category==="2"?e=["code","name"]:e=["code","name","path"];let p=!1;e.forEach(async d=>{await y.$refs.menuFormRef.validateField(d,C=>{C&&(r+=1)})}),setTimeout(async()=>{p=r===e.length,p&&(c.value=!0,v.value==="修改"?_e(o.menuForm).then(d=>{d.data.code===200?(u({type:"success",message:"修改成功!"}),c.value=!1,x.value=d.data.data,w()):(u({type:"warning",message:d.data.msg}),c.value=!1)}).catch(()=>{c.value=!1}):ye(o.menuForm).then(d=>{d.data.code===200?(u({type:"success",message:"新增成功!"}),c.value=!1,x.value=o.menu.id=d.data.data,v.value="修改",D.value=!1,w()):(u({type:"warning",message:d.data.msg}),c.value=!1)}).catch(()=>c.value=!1))})},K=()=>{if(!o.menuForm.id){u.warning("请先选择节点");return}if(o.menuForm.children&&o.menuForm.children.length>0){u.warning("请先删除下级节点");return}ue.confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>xe({ids:o.menuForm.id})).then(()=>{u({type:"success",message:"操作成功!"}),o.menuForm={id:"",code:"",name:"",parentId:"",parentName:"",path:"",sort:"",category:"1",icon:"Coin"},o.nodeData={},x.value="",k.value=1,v.value="保存",y.$refs.menuFormRef.resetFields(),w()}).catch(()=>{u({type:"info",message:"已取消删除"})})};return w(),(r,e)=>{const p=f("el-input"),d=f("el-button"),C=f("el-icon"),Q=f("el-tree"),_=f("el-form-item"),z=f("el-radio"),G=f("QuestionFilled"),W=f("el-popover"),J=f("el-form"),X=le("loading");return h(),S("div",he,[i("div",be,[i("div",Ve,[i("div",Fe,[l(p,{placeholder:"请输入内容","suffix-icon":"Search",modelValue:a(F),"onUpdate:modelValue":e[0]||(e[0]=s=>oe(F)?F.value=s:null),size:"small"},null,8,["modelValue"])]),i("div",De,[l(d,{type:"primary",size:"small",icon:"Plus",onClick:j},{default:n(()=>[m("新增")]),_:1}),l(d,{type:"danger",size:"small",icon:"Delete",onClick:K},{default:n(()=>[m("删除")]),_:1})])]),B((h(),S("div",{class:"tree-div",style:ne({height:a(I)+"px"}),"element-loading-text":"加载中","element-loading-spinner":"el-icon-loading"},[l(Q,{ref:"menuTree","node-key":"id",data:a(q),props:a(M),"default-expanded-keys":a($),"expand-on-click-node":!1,onNodeClick:O,"filter-node-method":L,"highlight-current":""},{default:n(({node:s,data:T})=>[l(C,{style:{color:"#409eff","font-size":"16px","vertical-align":"middle"}},{default:n(()=>[(h(),N(me(r.$icon[P(s,T)])))]),_:2},1024),i("span",we,U(T.name),1)]),_:1},8,["data","props","default-expanded-keys"])],4)),[[X,a(V)]])]),i("div",Ce,[ke,l(J,{labelWidth:"160px",model:a(t),rules:a(R),ref:"menuFormRef",class:"menu-form"},{default:n(()=>[l(_,{label:"编号:",prop:"code"},{default:n(()=>[l(p,{modelValue:a(t).code,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).code=s),maxlength:"40",size:"small",disabled:a(t).id==="1"},null,8,["modelValue","disabled"])]),_:1}),l(_,{label:"名称",prop:"name"},{default:n(()=>[l(p,{modelValue:a(t).name,"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).name=s),size:"small",maxlength:"40",disabled:a(t).id==="1"},null,8,["modelValue","disabled"])]),_:1}),l(_,{label:"上级菜单:"},{default:n(()=>[l(p,{modelValue:a(t).parentName,"onUpdate:modelValue":e[3]||(e[3]=s=>a(t).parentName=s),size:"small",disabled:""},null,8,["modelValue"])]),_:1}),l(_,{label:"类型:",prop:"category",disabled:a(t).id==="1"},{default:n(()=>[l(z,{modelValue:a(t).category,"onUpdate:modelValue":e[4]||(e[4]=s=>a(t).category=s),label:"1"},{default:n(()=>[m("菜单")]),_:1},8,["modelValue"]),l(z,{modelValue:a(t).category,"onUpdate:modelValue":e[5]||(e[5]=s=>a(t).category=s),label:"2"},{default:n(()=>[m("按钮")]),_:1},8,["modelValue"]),l(z,{modelValue:a(t).category,"onUpdate:modelValue":e[6]||(e[6]=s=>a(t).category=s),label:"3"},{default:n(()=>[m("iframe")]),_:1},8,["modelValue"])]),_:1},8,["disabled"]),B(l(_,{label:"路由地址:",prop:"path"},{label:n(()=>[m("路由地址: "),l(W,{placement:"top-start",width:"400",height:"500",trigger:"hover"},{reference:n(()=>[l(C,{style:{"margin-top":"6px","margin-left":"5px","font-size":"14px"}},{default:n(()=>[l(G)]),_:1})]),default:n(()=>[ze]),_:1})]),default:n(()=>[l(p,{size:"small",modelValue:a(t).path,"onUpdate:modelValue":e[7]||(e[7]=s=>a(t).path=s),maxlength:"50"},null,8,["modelValue"])]),_:1},512),[[ce,a(t).category==="1"||a(t).category==="3"]]),l(_,{label:"排序:",prop:"sort"},{default:n(()=>[l(p,{modelValue:a(t).sort,"onUpdate:modelValue":e[8]||(e[8]=s=>a(t).sort=s),modelModifiers:{number:!0},size:"small",maxlength:"2",disabled:a(t).id==="1"},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["model","rules"]),i("div",Ne,[a(c)?E("",!0):(h(),N(d,{key:0,size:"small",type:"primary",onClick:H},{default:n(()=>[m(U(a(v)),1)]),_:1})),a(c)?(h(),N(d,{key:1,size:"small",type:"primary",loading:!0},{default:n(()=>[m("保存中")]),_:1})):E("",!0)])])])}}}),Ue=Y(Te,[["__scopeId","data-v-a950e382"]]);export{Ue as default};
